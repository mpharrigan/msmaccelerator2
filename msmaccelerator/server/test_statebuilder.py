import os

from msmaccelerator.server.statebuilder import AmberStateBuilder
import mdtraj as md
from mdtraj.testing import get_fn

def test_amber():
    t = md.load(get_fn('native2.pdb'))
    
    builder = AmberStateBuilder()
    got = builder.build(t)

    correct = '''   22
   4.3000001  13.0999994   8.6000001   5.1999998  13.6000001   8.8000000
   4.9000001  14.2999995   9.5999998   5.6000000  14.1999996   7.9000002
   6.1000001  12.5000000   9.4000000   6.3999999  12.5000000  10.5999994
   6.6000003  11.5999997   8.5000002   6.4999998  11.5999997   7.5000000
   7.3000002  10.3999996   9.1000003   7.9000002  10.7000005  10.0000000
   6.2000000   9.4999999   9.5999998   5.6999999   9.1000003   8.8000000
   6.6000003   8.7000000  10.1999998   5.4000002  10.0000000  10.1999998
   8.3999997   9.8000002   8.1999999   8.3999997   9.9000001   6.9999999
   9.3000001   8.9999998   8.8000000   9.1000003   8.9999998   9.8000002
  10.4999995   8.3999997   8.2999998  10.7000005   7.6999998   9.1000003
  10.3999996   8.0000001   7.3000002  11.3000000   9.1000003   8.2999998
   1.0000000   2.0000000   3.0000000  90.0000000  90.0000000  90.0000000'''
    
    assert os.linesep.join(got.splitlines()[1:]) == correct


    
    

